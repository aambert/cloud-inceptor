#!/bin/sh -e
#
# rc.local
#
# This script is executed at the end of each multiuser runlevel.
# Make sure that the script will "exit 0" on success or any other
# value on error.
#
# In order to enable or disable this script just change the execution
# bits.
#
# By default this script does nothing.

if [ -e /root/.network_installed ]; then
    /root/.bin/restart_nics 2>&1 | tee -a /var/log/configure_network.log
else
    /root/.bin/configure_network 2>&1 | tee -a /var/log/configure_network.log
fi

if [ -e /root/.concourse_installed ]; then
    /root/.bin/restart_concourse 2>&1 | tee -a /var/log/configure_concourse.log
else
    /root/.bin/configure_concourse 2>&1 | tee -a /var/log/configure_concourse.log
fi

[ -e /root/.openvpn_installed ] \
    || /root/.bin/configure_openvpn 2>&1 | tee -a /var/log/configure_openvpn.log
[ -e /root/.smtp_installed ] \
    || /root/.bin/configure_smtp 2>&1 | tee -a /var/log/configure_smtp.log
[ -e /root/.squidproxy_installed ] \
    || /root/.bin/configure_squidproxy 2>&1 | tee -a /var/log/configure_squidproxy.log

[ -e /etc/openvpn/iptables-dump.ipt ] && iptables-restore < /etc/openvpn/iptables-dump.ipt

exit 0
